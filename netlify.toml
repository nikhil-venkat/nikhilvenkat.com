[build]
  # Base directory for the build (root of monorepo)
  base = "."
  
  # Build command that handles monorepo dependencies with cleanup
  command = "./build.sh"
  
  # Publish directory (where the built app will be)
  publish = "packages/app/build"

[build.environment]
  # Node.js version - using 20 to satisfy minimatch@10.0.3 requirements
  NODE_VERSION = "20"
  
  # Enable legacy OpenSSL provider for Node.js compatibility
  NODE_OPTIONS = "--openssl-legacy-provider"
  
  # Prevent npm ci issues in Lerna
  LERNA_DISABLE_NPM = "true"

# Redirect rules for SPA
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
